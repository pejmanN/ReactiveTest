@page "/adminproduct/edit/{Id:guid}"
@using ReactiveAndFodyTst.Client.ViewModels
@using System.Reactive.Linq
@inject NavigationManager NavigationManager
@inject ProductEditViewModel ViewModel

<h3>Edit Product</h3>

<div class="form-group">
    <label for="name">Name</label>
    <input id="name" class="form-control" @bind="ViewModel.Name" @bind:event="oninput" />
</div>

<div class="form-group">
    <label for="price">Price</label>
    <input id="price" type="number" class="form-control" @bind="ViewModel.Price" @bind:event="oninput" />
</div>

<button class="btn btn-primary"
        @onclick="@(() => ViewModel.UpdateCommand.Execute().Subscribe())"
        disabled="@(!ViewModel.UpdateCommand.CanExecute.FirstAsync().Wait())">
    Update
</button>
<button class="btn btn-secondary" @onclick="@(() => NavigationManager.NavigateTo("/admin/product"))">
    Cancel
</button>

@code {
    [Parameter]
    public Guid Id { get; set; }

    protected override async Task OnInitializedAsync()
    {
        await ViewModel.LoadProduct(Id);
    }
}